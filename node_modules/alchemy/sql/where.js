var F               = require('functionally')

module.exports = function(column){
    var self = this
    this.whereConditions = this.whereConditions || []

    var thisWhere    = this.where.bind(this)
    var thisToString = this.toString.bind(this)

    var all  = this.whereConditions

    var push = F.curry(function(operator, value, options){
        all.push([column, operator, value, options || {} ])

        return {
            and: thisWhere,
            toString: thisToString,
            end: function(){
                return self
            }
        }
    }, 2)

    return {
        equals: push('='),
        is: push('='),
        lt: push('<'),
        gt: push('>'),
        in: push(' in ')
    }
}