module.exports = function(config) {
    config = config || {}

    var parameterized = config.parameterized === undefined?
                            this.parameterized:
                            config.parameterized
    var where = ''

    if (this.whereConditions && this.whereConditions.length){
        where = this.whereConditions.map(function(cond, i){
            var col      = cond[0]
            var colName  = typeof col == 'string'? col: col.name
            var operator = cond[1]
            var value    = cond[2]

            var result = colName + ' ' + operator + ' '
            var type = cond[3].type
            var options = type? '::' + type: ''

            return parameterized?
                        result + '$' + (i + 1) + options:
                        result + this.valueToSql(value) + options
        }, this).join(' AND ')

        where = ' WHERE ' + where
    }

    return where
}